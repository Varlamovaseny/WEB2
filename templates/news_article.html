{% extends "base.html" %}

{% block title %}{{ article.title }} - Meow Blog{% endblock %}

{% block content %}
<div class="article-detail {% if is_today_article(article.date) %}today{% endif %}">
    <div class="article-header">
        <div class="article-title-wrapper">
            <h1>{{ article.title }}</h1>
            {% if is_today_article(article.date) %}
            <span class="new-badge new-badge-large">–ù–æ–≤–æ–µ!</span>
            {% endif %}
        </div>
        <div class="article-info">
            <span class="article-date {% if is_today_article(article.date) %}today{% endif %}">
                –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ: {{ article.date }}
            </span>
            <span class="article-id">ID: {{ article.id }}</span>
        </div>
    </div>

    {% if article.category %}
    <div class="article-category">
        <strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> {{ article.category }}
    </div>
    {% endif %}

    <div class="article-content">
        {{ article.content|safe }}

        {% if article.id > 3 %}
        <div class="article-notice">
            <p><em>–≠—Ç–∞ —Å—Ç–∞—Ç—å—è –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ. –°–∫–æ—Ä–æ –∑–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è –±–æ–ª—å—à–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞!</em></p>
        </div>
        {% endif %}
    </div>

    {% if author %}
    <div class="article-author">
        <div class="author-info">
            <div class="author-name">–ê–≤—Ç–æ—Ä: {{ author.name }}</div>
            <div class="author-email">{{ author.email }}</div>
        </div>
    </div>
    {% endif %}

    <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—å–µ–π -->
    <div class="article-actions">
        <a href="{{ url_for('edit_article', id=article.id) }}" class="edit-btn">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
        <a href="{{ url_for('delete_article', id=article.id) }}" class="delete-btn"
           onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É —Å—Ç–∞—Ç—å—é?')">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</a>
        <a href="{{ url_for('news') }}" class="back-to-news">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É –Ω–æ–≤–æ—Å—Ç–µ–π</a>
    </div>
</div>

<!-- –°–µ–∫—Ü–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ -->
<div class="comments-section">
    <h2>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ ({{ comments|length }})</h2>

    <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è -->
    <div class="comment-form">
        <h3>–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</h3>
        <form method="POST" action="{{ url_for('news_article', id=article.id) }}">
            <div class="form-group">
                <label for="author_name">–í–∞—à–µ –∏–º—è *</label>
                <input type="text" id="author_name" name="author_name"
                       value="{{ author_name or '' }}"
                       placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è" required>
                {% if errors and errors.author_name %}
                    <span class="error">{{ errors.author_name }}</span>
                {% endif %}
            </div>

            <div class="form-group">
                <label for="text">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π *</label>
                <textarea id="text" name="text"
                          placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..."
                          rows="4" required>{{ text or '' }}</textarea>
                {% if errors and errors.text %}
                    <span class="error">{{ errors.text }}</span>
                {% endif %}
            </div>

            <button type="submit" class="submit-btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</button>
        </form>
    </div>

    <!-- –°–ø–∏—Å–æ–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ -->
    <div class="comments-list">
        {% if comments %}
            {% for comment in comments %}
            <div class="comment-item">
                <div class="comment-header">
                    <strong class="comment-author">{{ comment.author_name }}</strong>
                    <span class="comment-date">{{ comment.date }}</span>
                </div>
                <div class="comment-text">
                    {{ comment.text }}
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="no-comments">
                <p>–ü–æ–∫–∞ –Ω–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</p>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}